[{"executedBy": "womullan", "actualEndDate": "2023-06-16T19:16:05.000Z", "executionDate": "2023-06-16T19:16:05.000Z", "scriptResults": [{"customFieldValues": [{"stringValue": "efd_summit = EfdClient('summit_efd')", "id": 7938, "customField": {"archived": false, "name": "Example Code", "index": 2, "id": 65, "type": "MULTI_LINE_TEXT", "projectId": 12800, "required": false}}], "expectedResult": "Another cell in the notebook with a second EFD connection to the summit EFD", "executionDate": "2023-06-16T18:44:58.000Z", "index": 3, "description": "Since we need to compare results between the summit and the USDF, also create a connection to the summit EFD. \u00c2\u00a0Use the EFD identifier name from the test case parameter, <span class=\"atwho-inserted\" data-atwho-at-query=\"{\" title=\"Summit EFD Identifier\" data-test-param-name=\"Summit EFD Identifier\">summit_efd</span>\u00e2\u0081\u00a0 , unless it is necessary to change at the time the test is executed. \u00c2\u00a0Record the value used if different.", "comment": "times out - you can not access efd_summit from USDF.<br>Connected to https://summit-lsp.lsst.codes/nb  this allows connections to both USDF and Summit EFD.", "status": "Pass"}, {"expectedResult": "A list of 5 valid SAL topics to be queried and a time window defined as astropy.Time objects.", "executionDate": "2023-06-16T18:58:19.000Z", "index": 4, "description": "Choose 5 topics to query and select a 6 day window of data. The window is arbitrary, but must be explicit (not relative to now()) so that it can be reproduced. The topics should be chosen to sample the various topic contexts. I.e. the topics should be chosen to sample both diagnostic topics like heartbeat monitors as well as both high and low cadence telemetry topics to get a broad view on how the system behaves with different kinds of topics.", "comment": "<pre>Random selction of five 'summit' topics ['lsst.sal.GIS.logevent_heartbeat', 'lsst.sal.ATOODS.logevent_heartbeat', 'lsst.sal.Test.logevent_heartbeat', 'lsst.sal.ESS.relativeHumidity', 'lsst.sal.ESS.logevent_heartbeat'] with messages on 2023-05-20</pre>", "status": "Pass"}, {"expectedResult": "A total of 10 pandas.DataFrame objects, 5 each for the summit and replicated EFDs. \u00c2\u00a0Each topic requires a separate query, so each will get its own DataFrame. \u00c2\u00a0All fields in each topic should be selected.", "executionDate": "2023-06-16T19:15:52.000Z", "index": 5, "description": "Issue selections at both the summit and the data facility. These selections should select all fields for the chosen topics.", "comment": "combined with next step ", "status": "Pass"}, {"expectedResult": "A cell in the notebook showing the DataFrames are the same length per topic between the summit and the replicated EFD. \u00c2\u00a0A cell showing the times in the index are the same for each topic. \u00c2\u00a0This could be done by converting to seconds and showing the difference is zero for every sample.<br /><br />If there are missing samples, the replication should be better than 99%. \u00c2\u00a0If it is not, the deviation must be traced to an intervening event or system other than the replication system itself to explain the discrepancy.", "executionDate": "2023-06-16T19:16:05.000Z", "index": 6, "description": "First compare the index for each topic between the summit and replicated EFD. \u00c2\u00a0There should be:<br /><ol><li>The same number of samples in each topic for each location</li><li>Given 1) each time stamp should represent the same time</li></ol>Reliability of the replication must be at better than 99%.  If there are samples missing from the replicated datasets, confirm that the length of the replicated DataFrame divided by the length of the summit DataFrame is greater than 0.99 for all topics.", "comment": "<pre>lsst.sal.GIS.logevent_heartbeat had 189633 messages - summit had 189615\nlsst.sal.GIS.logevent_heartbeat does not match\nlsst.sal.ATOODS.logevent_heartbeat had 186155 messages - summit had 186148\nlsst.sal.ATOODS.logevent_heartbeat does not match\nlsst.sal.Test.logevent_heartbeat had 188501 messages - summit had 188484\nlsst.sal.Test.logevent_heartbeat does not match\nlsst.sal.ESS.relativeHumidity had 528737 messages - summit had 528478\nlsst.sal.ESS.relativeHumidity does not match</pre>", "status": "Fail"}, {"expectedResult": "A cell or cells showing that all fields for all topics evaluate as equivalent given appropriate precision.", "executionDate": "2023-06-16T20:15:21.000Z", "index": 7, "description": "Compare the fields for each topic between the summit and the replicated EFDs. \u00c2\u00a0They should be equivalent to double precision. \u00c2\u00a0This can be done by looping over the topics and fields and showing numpy.all (or similar) evaluates to True.", "status": "Blocked"}, {"expectedResult": "A histogram or similar showing that the difference private_seqNum[1:] - private_seqnum[:-1] is 1 more than 99.9% of the time.", "executionDate": "2023-06-16T20:43:49.000Z", "index": 8, "description": "Examine the summit messages to confirm that the reliability is better than 99.9% for all topics. \u00c2\u00a0Keep in mind that the private_seqNum is intended to be a sequentially increasing index of the messages, but that it gets reset after every CSC reboot. \u00c2\u00a0This must be accounted for by applying an offset when a reset is observed.<br />Show the reliability is better than 99.9% by showing that the private_seqNum is sequential better than 99.9% of the time (when correcte for resets).", "comment": "<div data-mime-type=\"application/vnd.jupyter.stdout\"><pre>lsst.sal.GIS.logevent_heartbeat private_seqNum increases 100.0% of the sequence\nlsst.sal.ATOODS.logevent_heartbeat private_seqNum increases 100.0% of the sequence\nlsst.sal.Test.logevent_heartbeat private_seqNum increases 100.0% of the sequence\nlsst.sal.ESS.relativeHumidity private_seqNum increases 100.0% of the sequence\nlsst.sal.ESS.logevent_heartbeat private_seqNum increases 100.0% of the sequence</pre></div>", "status": "Pass"}, {"expectedResult": "<ul><li>A document describing the process including topics and time window.</li><li>The document shall be in the form of a notebook with saved outputs, or similar</li></ul>", "executionDate": "2023-06-16T20:44:16.000Z", "index": 9, "description": "Document the procedure including topics chosen, time window, replication reliability and EFD reliability", "comment": "Added LVV-T2334.ipynb to the test report repo", "status": "Pass"}, {"expectedResult": "The JupyterLab interface is displayed in the browser", "executionDate": "2023-06-16T18:24:01.000Z", "index": 0, "description": "Log in to the USDF notebook aspect: https://usdf-rsp-dev.slac.stanford.edu/<br />Make sure to choose a recent weekly release and a large instance; record the chosen release and whether or not it is the current \"recommended\" release.", "comment": "Logged in choose large with latest weekly (23)", "status": "Pass"}, {"expectedResult": "An empty notebook running in the LSST kernel", "executionDate": "2023-06-16T18:24:10.000Z", "index": 1, "description": "Open a notebook:<ol><li>Navigate to the File-&gt;New-&gt;Notebook</li><li>When prompted, select the LSST kernel</li></ol>", "comment": "Created a notebook LVV-T2338", "status": "Pass"}, {"customFieldValues": [{"stringValue": "from lsst_efd_client import EfdClient<br />efd = EfdClient('usdf_efd')", "id": 8277, "customField": {"archived": false, "name": "Example Code", "index": 2, "id": 65, "type": "MULTI_LINE_TEXT", "projectId": 12800, "required": false}}], "expectedResult": "A notebook with an instance of the `EfdClient` configured to talk to the NCSA EFD", "executionDate": "2023-06-16T18:43:27.000Z", "index": 2, "description": "Connect to the USDF EFD.<br />Use the EFD identifier name from the test case parameter, <span class=\"atwho-inserted\" data-atwho-at-query=\"{\" title=\"EFD Identifier\" data-test-param-name=\"EFD Identifier\">ldf_stable_efd</span>\u00e2\u0081\u00a0 , unless it is necessary to change at the time the test is executed. \u00c2\u00a0Record the value used if different.", "comment": "<img src=\"../rest/tests/1.0/attachment/image/3911\" style=\"width: 300px;\" class=\"fr-fic fr-fil fr-dib\">", "status": "Pass"}], "assignedTo": "womullan", "userKey": "womullan", "testCaseKey": "LVV-T2338", "automated": false, "environment": "Vendor Facility", "actualStartDate": "2023-06-16T18:24:01.000Z", "id": 1845, "projectId": 12800, "key": "LVV-E1457", "status": "Fail"}, {"executedBy": "womullan", "actualEndDate": "2023-06-20T16:25:58.000Z", "executionDate": "2023-06-20T16:25:58.000Z", "scriptResults": [{"expectedResult": "The JupyterLab interface is displayed in the browser", "executionDate": "2023-06-20T15:38:25.000Z", "index": 0, "description": "Log in to the USDF notebook aspect: https://usdf-rsp-dev.slac.stanford.edu/<br />Make sure to choose a recent weekly release and a large instance; record the chosen release and whether or not it is the current \"recommended\" release.", "comment": "logged in have RSP at USDF ", "status": "Pass"}, {"expectedResult": "An empty notebook running in the LSST kernel", "executionDate": "2023-06-20T15:39:24.000Z", "index": 1, "description": "Open a notebook:<ol><li>Navigate to the File-&gt;New-&gt;Notebook</li><li>When prompted, select the LSST kernel</li></ol>", "comment": "Copied LVV-T2338.ipynb to LVV-TT339.ipynb", "status": "Pass"}, {"customFieldValues": [{"stringValue": "from lsst_efd_client import EfdClient<br />efd = EfdClient('{EFD_ID}')  ", "id": 8278, "customField": {"archived": false, "name": "Example Code", "index": 2, "id": 65, "type": "MULTI_LINE_TEXT", "projectId": 12800, "required": false}}], "expectedResult": "A notebook with an instance of the `EfdClient` configured to talk to the USDF EFD", "executionDate": "2023-06-20T15:39:33.000Z", "index": 2, "description": "Connect to the USDF EFD.<br />Use the EFD identifier name from the test case parameter, <span class=\"atwho-inserted\" data-atwho-at-query=\"{\" title=\"EFD_ID\" data-test-param-name=\"EFD_ID\">usdf_efd</span>\u00e2\u0081\u00a0 \u00e2\u0081\u00a0 , unless it is necessary to change at the time the test is executed. \u00c2\u00a0Record the value used if different.", "comment": "Last executed at 2023-06-16 19:50:41 in 3.71s", "status": "Pass"}, {"expectedResult": "A cell in a notebook specifying topic names and start and end times for a 6 day window as astropy.Time objects.", "index": 3, "description": "Choose 3 topics to query and select a 6 day window of data. The window is arbitrary, but must be explicit (not relative to now()) so that it can be reproduced. The topics are also arbitrary but will sample multiple subsystems.", "comment": "<div><pre>lsst.sal.ATPneumatics.logevent_heartbeat had 529266 messages between 2023-06-13 and 2023-06-20 \nlsst.sal.MTAirCompressor.logevent_summaryState had 22 messages between 2023-06-13 and 2023-06-20 \nlsst.sal.MTM1M3.logevent_raisingLoweringInfo had 6582 messages between 2023-06-13 and 2023-06-20 \nRandom selction of 3 'usdf' topics ['lsst.sal.ATPneumatics.logevent_heartbeat', 'lsst.sal.MTAirCompressor.logevent_summaryState', 'lsst.sal.MTM1M3.logevent_raisingLoweringInfo'] with messages between 2023-06-13 and 2023-06-20</pre></div>", "status": "Not Executed"}, {"expectedResult": "A cell in a notebook with 1 DataFrame per topic. This shall be explicit about all the necessary steps and any hand tuning necessary to make it possible to make selections from the archival data.", "executionDate": "2023-06-20T15:54:51.000Z", "index": 4, "description": "Use the defined topics and the time window to read in fields from the chosen topics. These are expected to be pandas.DataFrames.", "comment": "<div data-mime-type=\"application/vnd.jupyter.stdout\"><pre>lsst.sal.ATPneumatics.logevent_heartbeat has fields:Index(['heartbeat', 'private_efdStamp', 'private_identity',\n       'private_kafkaStamp', 'private_origin', 'private_rcvStamp',\n       'private_revCode', 'private_seqNum', 'private_sndStamp'],\n      dtype='object')\nlsst.sal.MTAirCompressor.logevent_summaryState has fields:Index(['private_efdStamp', 'private_identity', 'private_kafkaStamp',\n       'private_origin', 'private_rcvStamp', 'private_revCode',\n       'private_seqNum', 'private_sndStamp', 'salIndex', 'summaryState'],\n      dtype='object')\nlsst.sal.MTM1M3.logevent_raisingLoweringInfo has fields:Index(['private_efdStamp', 'private_identity', 'private_kafkaStamp',\n       'private_origin', 'private_rcvStamp', 'private_revCode',\n       'private_seqNum', 'private_sndStamp', 'waitAirPressure',\n       'waitHardpoint0',\n       ...\n       'waitZForceActuator91', 'waitZForceActuator92', 'waitZForceActuator93',\n       'waitZForceActuator94', 'waitZForceActuator95', 'waitZForceActuator96',\n       'waitZForceActuator97', 'waitZForceActuator98', 'waitZForceActuator99',\n       'weightSupportedPercent'],\n      dtype='object', length=284)</pre></div>", "status": "Pass"}, {"expectedResult": "Plots of quantities including filtering and other common activities. \u00c2\u00a0This shall specifically identify cases where there is an obvious difference between how the interaction would be done with the running EFD vs the archival version.", "executionDate": "2023-06-20T16:22:43.000Z", "index": 5, "description": "Execute various analysis tasks, e.g. plotting various quantities, to show that it is practical to do so.", "comment": "not so interesting plots like this<br><img src=\"../rest/tests/1.0/attachment/image/3922\" style=\"width: 300px;\" class=\"fr-fic fr-fil fr-dib\"><img src=\"../rest/tests/1.0/attachment/image/3920\" style=\"width:300px;\" class=\"fr-fic fr-fil fr-dib\">", "status": "Pass"}, {"expectedResult": "<ul><li>A document describing the process including the topics chosen and the time window.</li><li>The document shall be in the form of a notebook with saved outputs.</li></ul>", "executionDate": "2023-06-20T16:24:57.000Z", "index": 6, "description": "Document the procedure including topics and time window. \u00c2\u00a0Particular attention shall be paid to differences in interactions between the running EFD and the archival version. \u00c2\u00a0If any topics chosen for this test were downsampled in the archiving process, the document shall report on the self consistency of the down/re-sampling of those topics.", "comment": "LVV-T2339.ipynb added to the DMTR-331 repo - also renderd at the end fo the test report (\\secref{sec:LVV-T2339nb})<br><br>", "status": "Pass"}], "assignedTo": "womullan", "userKey": "womullan", "executionTime": 2733000, "testCaseKey": "LVV-T2339", "automated": false, "actualStartDate": "2023-06-20T15:38:20.000Z", "id": 1940, "projectId": 12800, "key": "LVV-E1552", "status": "Pass"}]